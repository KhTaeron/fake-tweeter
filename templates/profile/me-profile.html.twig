{# templates/profile/show.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Profil de {{ user.pseudo }}{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/profile.css') }}">
{% endblock %}


{% block body %}
<div class="profile-container">
    <div class="profile-header">
        <a href="{{ path('tweets_home') }}" class="home-link">‚Üê Retour aux tweets</a>
        <h1>Bienvenue sur votre profil, {{ user.pseudo }}</h1>
        <a href="{{ path('profile_edit') }}" class="edit-link" title="Modifier le profil">‚úèÔ∏è</a>
    </div>

    {% if user.avatar %}
        <img src="{{ asset('uploads/avatars/' ~ user.avatar.path) }}" alt="Avatar" />

        <script>
            console.log("Avatar path:", "{{ asset('uploads/avatars/' ~ user.avatar.path) }}");
        </script>
    {% else %}
        <script>
            console.log("Aucun avatar pour cet utilisateur.");
        </script>
    {% endif %}
    
    <ul class="profile-info">
        <li><strong>Pseudo :</strong> {{ user.pseudo }}</li>
        <li><strong>Date d'inscription :</strong> {{ user.registrationDate|date('d/m/Y') }}</li>
    </ul>

    <div>
        <div class="section-title">Tweets</div>
        {% for tweet in user.tweets %}
            <div class="tweet">
                <p>{{ tweet.content }}</p>
                <time>{{ tweet.publicationDate|date('d/m/Y H:i') }}</time>
            </div>
        {% else %}
            <p class="empty">Aucun tweet</p>
        {% endfor %}
    </div>

    <div>
        <div class="section-title">Abonnements</div>
        {% for subscription in user.subscriptions %}
            <a href="{{ path('profile_show', {'id': subscription.followedUser.id}) }}">
                <div class="following">
                        {{ subscription.followedUser.pseudo }}
                </div>
            </a>
        {% else %}
            <p class="empty">Aucun abonnement</p>
        {% endfor %}
    </div>

    <div>
        <div class="section-title">Abonn√©s</div>
        {% for subscription in user.followers %}
            <a href="{{ path('profile_show', {'id': subscription.followingUser.id}) }}">
                <div class="follower">
                        {{ subscription.followingUser.pseudo }}
                </div>
            </a>
        {% else %}
            <p class="empty">Aucun abonn√©</p>
        {% endfor %}
    </div>
    
    <form method="delete" action="{{ path('profile_delete') }}">
        <input type="hidden" name="_method" value="DELETE">
        <button type="submit" onclick="return confirm('Supprimer votre compte ?')">
            üóëÔ∏è Supprimer mon compte
        </button>
    </form>

</div>
{% endblock %}
